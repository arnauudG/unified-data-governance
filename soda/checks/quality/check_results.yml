# QUALITY Layer - Check Results Table Quality Checks
# Database: SODA_CERTIFICATION, Schema: QUALITY
# Table: check_results (variable records)
# 
# DECISION: "Can we trust the quality monitoring system itself?"
# RISK: Broken quality monitoring = blind to data issues
# QUALITY DIMENSIONS: Schema, Validity (format errors break monitoring)

# Soda Cloud Profiling Configuration for Partner Certification
profile columns:
  columns:
    - CHECK_RESULTS.%
    - exclude CHECK_RESULTS.CHECK_TIMESTAMP
    - exclude CHECK_RESULTS.CREATED_AT
    - exclude CHECK_RESULTS.UPDATED_AT
    - exclude CHECK_RESULTS.EXECUTION_TIME_MS
    - exclude CHECK_RESULTS.ROWS_CHECKED
    - exclude CHECK_RESULTS.ROWS_FAILED

sample datasets:
  datasets:
    - include CHECK_RESULTS

checks for CHECK_RESULTS:
  # Schema validation - structure matters for quality monitoring
  - schema:
      name: "Quality check results schema validation"
      attributes:
        dimension: Validity
      fail:
        when required column missing: [CHECK_ID, TABLE_NAME, CHECK_STATUS, CHECK_TYPE, CHECK_TIMESTAMP]
        when forbidden column present: [DUPLICATE_CHECK_ID, TEST_COLUMN]
  
  # Validity - format errors break monitoring
  - invalid_count(CHECK_STATUS) = 0:
      name: "All check statuses are valid"
      valid values: ['pass', 'fail', 'warn', 'error']
      attributes:
        dimension: Validity
  
  - invalid_count(CHECK_TYPE) = 0:
      name: "All check types are valid"
      valid values: ['row_count', 'missing_count', 'duplicate_count', 'invalid_count', 'freshness', 'schema']
      attributes:
        dimension: Validity
